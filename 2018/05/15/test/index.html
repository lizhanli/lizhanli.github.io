<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        iOS开发CoreAnimation - undefined
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i>  </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar">
            <img src="/images/01.jpg" />
        </div>
        <div class="name">
            <i>li战神</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>HOME</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>TAGS</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>ARCHIVES</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>ABOUT</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、CAAnimation属性和方法"><span class="toc-text">1、CAAnimation属性和方法</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">search</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>
        <div class="index-about-mobile">
            <i>  </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        iOS开发CoreAnimation
    </div>

    <div class="post-meta">
        <span class="attr">Post：<span>2018-05-15 00:28:52</span></span>
        
        </span>
        <span class="attr">Visit：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <p>#iOS开发CoreAnimation<br>CAAnimation 是CoreAnimation 框架中的基类，如图所示<br><img src="https://static.oschina.net/uploads/space/2015/1204/172312_5Zup_2340880.png" alt="CAAnimation"><br>从图中我们可以分析出 CAAnimation 分为3个子类</p>
<ul>
<li>CAPropertyAnimation  属性动画</li>
<li>CATransition         转场动画</li>
<li>CAAnimationGroup     组合动画</li>
</ul>
<h3 id="1、CAAnimation属性和方法"><a href="#1、CAAnimation属性和方法" class="headerlink" title="1、CAAnimation属性和方法"></a>1、CAAnimation属性和方法</h3><p> CAAnimation作为动画对象的基类，其中封装了动画的基础属性，如下：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//通过类方法创建一个CAAnimation对象</span><br><span class="line">+ (instancetype)animation;</span><br><span class="line">//动画执行的时序模式</span><br><span class="line">@property(nullable, strong) CAMediaTimingFunction  *timingFunction;</span><br><span class="line">//代理</span><br><span class="line">@property(nullable, strong) id delegate;</span><br><span class="line">//是否动画完成时将动画对象移除掉</span><br><span class="line">@property(getter=isRemovedOnCompletion) BOOL       removedOnCompletion;</span><br></pre></td></tr></table></figure>
<p>   timingFunction定义了动画执行的时序效果，CAMediaTimingFunction的创建方式如下：</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">  /*</span><br><span class="line">  name参数决定的执行的效果，可选参数如下</span><br><span class="line">  //线性执行</span><br><span class="line">  NSString * const kCAMediaTimingFunctionLinear;</span><br><span class="line">  //淡入  在动画开始时 淡入效果</span><br><span class="line">  NSString * const kCAMediaTimingFunctionEaseIn;</span><br><span class="line">  //淡出 在动画结束时 淡出效果</span><br><span class="line">  NSString * const kCAMediaTimingFunctionEaseOut;</span><br><span class="line">  //淡入淡出</span><br><span class="line">  NSString * const kCAMediaTimingFunctionEaseInEaseOut;</span><br><span class="line"> //默认效果</span><br><span class="line"> NSString * const kCAMediaTimingFunctionDefault;</span><br><span class="line"> */</span><br><span class="line">+ (instancetype)functionWithName:(NSString *)name;</span><br></pre></td></tr></table></figure>
<p> CAAnimation的代理方法入如下几个：</p>
<p>   //动画开始时执行的回调</p>
<ul>
<li><p>(void)animationDidStart:(CAAnimation *)anim;<br>//动画结束后执行的回调</p>
</li>
<li><p>(void)animationDidStop:(CAAnimation *)anim finished:(BOOL)flag;</p>
</li>
</ul>
<p>###2、CAPropertyAnimation属性与方法<br>CAPropertyAnimation是继承于CAAnimation专门用来创建与属性相关的动画的类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//创建对象 参数中的path就是我们要执行动画的属性</span><br><span class="line">//例如，如果传入@&quot;backgroundColor&quot; 当layer的背景颜色改变时，就会执行我们设置的动画</span><br><span class="line">+ (instancetype)animationWithKeyPath:(nullable NSString *)path;</span><br><span class="line">//这个属性确定动画执行的状态是否叠加在控件的原状态上</span><br><span class="line">//默认设置为NO，如果我们执行两次位置移动的动画，会从同一位置执行两次</span><br><span class="line">//如果设置为YES，则会在第一次执行的基础上执行第二次动画</span><br><span class="line"></span><br><span class="line">@property(getter=isAdditive) BOOL additive;</span><br><span class="line">//这个属性对重复执行的动画有效果</span><br><span class="line">//默认为NO，重复执行的动画每次都是从起始状态开始</span><br><span class="line">//如果设置为yes，则为此执行都会在上一次执行的基础上执行</span><br><span class="line"></span><br><span class="line">@property(getter=isCumulative) BOOL cumulative;</span><br><span class="line">//这个属性和transfron属性的动画执行相关</span><br><span class="line">@property(nullable, strong) CAValueFunction *valueFunction;</span><br></pre></td></tr></table></figure>
<p>上面这些属性中，只有一个需要我们注意，valueFunction是专门为了transform动画而设置的，因为我们没有办法直接改变transform3D中的属性，通过这个参数，可以帮助我们直接操作transfrom3D属性变化产生动画效果，举例如下，一个绕Z轴旋转的动画：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">//绕z轴旋转的动画</span><br><span class="line"></span><br><span class="line">   CABasicAnimation * ani = [CABasicAnimation animationWithKeyPath:@&quot;transform&quot;];</span><br><span class="line"></span><br><span class="line">   //从0度开始</span><br><span class="line"></span><br><span class="line">   ani.fromValue = @0;</span><br><span class="line"></span><br><span class="line">   //旋转到180度</span><br><span class="line"></span><br><span class="line">   ani.toValue = [NSNumber numberWithFloat:M_PI];</span><br><span class="line"></span><br><span class="line">   //时间2S</span><br><span class="line"></span><br><span class="line">   ani.duration = 2;</span><br><span class="line"></span><br><span class="line">   //设置为z轴旋转</span><br><span class="line"></span><br><span class="line">   ani.valueFunction = [CAValueFunction functionWithName:kCAValueFunctionRotateZ];</span><br><span class="line"></span><br><span class="line">   //执行动画</span><br><span class="line"></span><br><span class="line">   [layer addAnimation:ani forKey:@&quot;&quot;];</span><br></pre></td></tr></table></figure>
<p>实际上，使用点的方式也是可以访问到相应属性的，如果不设置valueFunction，使用如下方法也是可以进行绕Z轴旋转的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//绕z轴旋转的动画</span><br><span class="line"></span><br><span class="line">    CABasicAnimation * ani = [CABasicAnimation animationWithKeyPath:@&quot;transform.rotation.z&quot;];</span><br><span class="line"></span><br><span class="line">    //从0度开始</span><br><span class="line"></span><br><span class="line">    ani.fromValue = @0;</span><br><span class="line"></span><br><span class="line">    //旋转到180度</span><br><span class="line"></span><br><span class="line">    ani.toValue = [NSNumber numberWithFloat:M_PI];</span><br><span class="line"></span><br><span class="line">    //时间2S</span><br><span class="line"></span><br><span class="line">    ani.duration = 2;</span><br><span class="line"></span><br><span class="line">    //执行动画</span><br><span class="line"></span><br><span class="line">    [layer addAnimation:ani forKey:@&quot;&quot;];</span><br></pre></td></tr></table></figure>
<p>###3、CABasicAnimation属性<br>CABasicAnimaton是CAPropertyAnimation分出来的一个子类，创建基础的属性变化动画，例如我们上面的示例代码，其中属性如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@property(nullable, strong) id fromValue;</span><br><span class="line">@property(nullable, strong) id toValue;</span><br><span class="line">@property(nullable, strong) id byValue;</span><br></pre></td></tr></table></figure>
<p>上面三个属性都是来确定动画的起始与结束位置，有如下的含义：</p>
<p>fromValue和toValue不为空：动画的值由fromValue变化到toValue</p>
<p>fromValue和byValue不为空：动画的值由fromValue变化到fromValue+byValue</p>
<p>byValue和toValue不为空：动画的值由toValue-byValue变化到toValue</p>
<p>只有fromValue不为空：动画的值由fromValue变化到layer的当前状态值</p>
<p>只有toValue不为空：动画的值由layer当前的值变化到toValue</p>
<p>只有byValue不为空：动画的值由layer当前的值变化到layer当前的值+byValue</p>
<p>###4、CAKeyframeAnimation关键帧动画<br>CAKeyframeAnimation也是继承与CAPropertyAnimation的一个子类，其与CABasicAnimation的不同之处在于虽然其都是改变layer层属性的动画，但是CABasicAnimation只能设置初始与结束状态，这之间我们没办法控制，而CAKeyframeAnimation可以让我们设置一些关键帧再整个动画的过程中。属性方法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">//关键帧的值数组 例如我们想让控件沿某个路径移动，这里面存放每个移动的点</span><br><span class="line">@property(nullable, copy) NSArray *values;</span><br><span class="line">//直接设置路径，作用域values类似</span><br><span class="line">@property(nullable) CGPathRef path;</span><br><span class="line">//设置每一帧执行的时间长短 这个的取值为0-1，代表占用时间的比例</span><br><span class="line">@property(nullable, copy) NSArray&lt;NSNumber *&gt; *keyTimes;</span><br><span class="line">//每一帧执行过程中的时序效果 上面有提过</span><br><span class="line">@property(nullable, copy) NSArray&lt;CAMediaTimingFunction *&gt; *timingFunctions;</span><br><span class="line">/*</span><br><span class="line">设置帧的中间值如何计算</span><br><span class="line"></span><br><span class="line"> NSString * const kCAAnimationLinear;</span><br><span class="line"></span><br><span class="line"> NSString * const kCAAnimationDiscrete;</span><br><span class="line"></span><br><span class="line"> NSString * const kCAAnimationPaced;</span><br><span class="line"></span><br><span class="line"> NSString * const kCAAnimationCubic;</span><br><span class="line"></span><br><span class="line"> NSString * const kCAAnimationCubicPaced;</span><br><span class="line">*/</span><br><span class="line">@property(copy) NSString *calculationMode;</span><br></pre></td></tr></table></figure>
<p>示例如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CAKeyframeAnimation * ani = [CAKeyframeAnimation animationWithKeyPath:@&quot;position&quot;];</span><br><span class="line">ani.values = @[[NSValue valueWithCGPoint:CGPointMake(100, 100)],[NSValue valueWithCGPoint:CGPointMake(120, 100)],[NSValue valueWithCGPoint:CGPointMake(120, 200)],[NSValue valueWithCGPoint:CGPointMake(200, 200)]];</span><br><span class="line">ani.duration = 3;</span><br><span class="line">[layer addAnimation:ani forKey:@&quot;&quot;];</span><br></pre></td></tr></table></figure>
<p>###5、CASpringAnimation阻尼动画<br> 通过CASpringAnimation，可以帮助开发者很轻松的创建出有弹簧效果的动画，主要属性如下：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> //这个属性设置弹簧重物的质量 会影响惯性 必须大于0 默认为1</span><br><span class="line">@property CGFloat mass;</span><br><span class="line">//设置弹簧的刚度系数，必须大于0 默认为100  这个越大 则回弹越快</span><br><span class="line">@property CGFloat stiffness;</span><br><span class="line">//阻尼系数 默认为10 必须大于0 这个值越大 回弹的幅度越小</span><br><span class="line">@property CGFloat damping;</span><br><span class="line">//初始速度</span><br><span class="line">@property CGFloat initialVelocity;</span><br><span class="line">//获取动画停下来需要的时间</span><br><span class="line">@property(readonly) CFTimeInterval settlingDuration;</span><br></pre></td></tr></table></figure>
<p>###6、转场动画<br> CATransition和CAPropertyAnimation的不同之处在于当layer层出现时，会产生动画效果，而并不是属性改变时，属性如下：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"> /*</span><br><span class="line">设置动画类型</span><br><span class="line">//淡入</span><br><span class="line"></span><br><span class="line"> NSString * const kCATransitionFade;</span><br><span class="line"></span><br><span class="line"> //移入</span><br><span class="line"></span><br><span class="line"> NSString * const kCATransitionMoveIn;</span><br><span class="line"></span><br><span class="line"> //压入</span><br><span class="line"></span><br><span class="line"> NSString * const kCATransitionPush;</span><br><span class="line"></span><br><span class="line"> //溶解</span><br><span class="line"></span><br><span class="line"> NSString * const kCATransitionReveal;</span><br><span class="line">*/</span><br><span class="line">@property(copy) NSString *type;</span><br><span class="line">/*</span><br><span class="line">设置动画的方向</span><br><span class="line">//从右侧进</span><br><span class="line"></span><br><span class="line"> NSString * const kCATransitionFromRight;</span><br><span class="line"></span><br><span class="line"> //从左侧进</span><br><span class="line"></span><br><span class="line"> NSString * const kCATransitionFromLeft;</span><br><span class="line"></span><br><span class="line"> //从上侧进</span><br><span class="line"></span><br><span class="line"> NSString * const kCATransitionFromTop;</span><br><span class="line"></span><br><span class="line"> //从下侧进</span><br><span class="line"></span><br><span class="line"> NSString * const kCATransitionFromBottom;</span><br><span class="line">*/</span><br><span class="line">@property(nullable, copy) NSString *subtype;</span><br><span class="line">其实，关于type定义的动画效果，出来官方定义的，我们还可以使用一些私有的参数，如下：</span><br><span class="line">pageCurl   翻页</span><br><span class="line">rippleEffect 滴水效果</span><br><span class="line">suckEffect 收缩效果，如一块布被抽走</span><br><span class="line">cube 立方体效果</span><br><span class="line">oglFlip 上下翻转效果</span><br><span class="line"> ``` </span><br><span class="line">###7、CAAnimationGroup动画组</span><br><span class="line">CAAnimationGroup本身并没有定义动画，他可以将我们上面提到的相关动画进行组合：</span><br></pre></td></tr></table></figure>
<p>@property(nullable, copy) NSArray<caanimation *=""> *animations;<br><code>`</code><br><a href="https://yq.aliyun.com/articles/39396?spm=a2c4e.11153940.blogcont39398.18.61ea7f98mO2UhO" target="_blank" rel="noopener">原文链接</a></caanimation></p>

        
        <div id="comment-container">
        </div>
    </div>
</div>
    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        

        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = ""
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

</html>
